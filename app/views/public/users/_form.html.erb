  <%= form_with model: user do |f| %>
    <div class="ProfileImage">
      <label for="inputImage">ProfileImage</label>
      <%= image_tag user.profile_image, class: "card img-square rounded-circle", fallback: "icon_user.png", size: "100x100" %>
      <%= f.file_field :profile_image, id: "image", accept: "image/*" %>
    </div>

    <!--ゲストユーザーでログインした場合には編集できない-->
    <% if user.name == "guestuser" %>
      UserName：<%= user.name %>
    <% elsif %>
      <div class="UserName">
        <label for="inputName">UserName</label>
        <%= f.text_field :name, autofocus: true, id:"inputName", placeholder:"名前" %>
      </div>
    <% end %>

    <!--性別選択-->
    <div class="Sex">
      <label for="Sex">Sex</label>
      <!--男性-->
      <%= f.radio_button :sex, User.sexes.key(0) %>
      <%= f.label :sex_men, User.sexes_i18n[:men] %>
      <!--女性-->
      <%= f.radio_button :sex, User.sexes.key(1) %>
      <%= f.label :sex_women, User.sexes_i18n[:women] %>
      <!--その他-->
      <%= f.radio_button :sex, User.sexes.key(2) %>
      <%= f.label :sex_others, User.sexes_i18n[:others] %>
    </div>

    <div class="BirthDate">
      <label for="BirthDate">BirthDate</label>
      <%= f.date_field :birthdate %>
    </div>

    <div class="Introduction">
      <label for="Introduction">Introduction</label>
      <%= f.text_field :introduction, placeholder:"自己紹介文" %>
    </div>
    <%= f.submit "変更を保存" %>
  <% end %>

<%= link_to "アカウント情報編集", edit_user_registration_path, class: "user-edit-btn" %>

<script>
  $(function() {
      // 画像が選択された時に発火
      $('#image').on('change', function() {
        // this.files[0]は、選択された画像のこと
        // selectedFileに、選択された画像を格納を宣言
        var selectedFile = this.files[0];
        // FileReaderを起動
        var fileReader = new FileReader();
        // selectedFile(選択された画像)をbase64文字列に変換
        // HTML上で画像を表示するには画像を文字列に変換する必要があるため
        // .onloadは、処理が成功したら次に行く記述
        fileReader.onload = function(event) {
          // 画像ファイルが文字列に変換成功したらイベントが発火
          var loadedImageUri = event.target.result;
          // loadedImageUriに、文字列化した画像ファイルを格納
          $('.img-square').attr('src', loadedImageUri);
        };
        fileReader.readAsDataURL(selectedFile);
      });
    });
</script>